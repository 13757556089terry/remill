/* Copyright 2015 Peter Goodman (peter@trailofbits.com), all rights reserved. */

namespace {

template <typename D, typename S>
DEF_SEM(MOV, D dst, S src) {
  W(dst) = R(src);
}

}  // namespace

DEF_ISEL(MOV_GPR8_IMMb_C6r0_8) = MOV<R8W, I8>;
DEF_ISEL(MOV_MEMb_IMMb_8) = MOV<M8, I8>;

DEF_ISEL_Rn_In(MOV_GPRv_IMMz, MOV);
DEF_ISEL_Mn_In(MOV_MEMv_IMMz, MOV);

DEF_ISEL(MOV_GPR8_GPR8_88_8) = MOV<R8W, R8>;
DEF_ISEL(MOV_MEMb_GPR8_8) = MOV<M8, R8>;

DEF_ISEL_Mn_Rn(MOV_MEMv_GPRv, MOV);
DEF_ISEL_Rn_Rn(MOV_GPRv_GPRv_89, MOV);

DEF_ISEL(MOV_GPR8_MEMb_8) = MOV<R8W, M8>;
DEF_ISEL(MOV_GPR8_GPR8_8A_8) = MOV<R8W, R8>;

DEF_ISEL_Rn_Mn(MOV_GPRv_MEMv, MOV);
DEF_ISEL_Mn_Rn(MOV_MEMv_GPRv_8B, MOV);

//1148 MOV MOV_MEMw_SEG DATAXFER BASE I86 ATTRIBUTES:
//1149 MOV MOV_GPRv_SEG DATAXFER BASE I86 ATTRIBUTES: SCALABLE
//1150 MOV MOV_SEG_MEMw DATAXFER BASE I86 ATTRIBUTES: NOTSX
//1151 MOV MOV_SEG_GPR16 DATAXFER BASE I86 ATTRIBUTES: NOTSX

DEF_ISEL(MOV_AL_MEMb_8) = MOV<R8W, M8>;

DEF_ISEL_Rn_Mn(MOV_OrAX_MEMv, MOV);

DEF_ISEL(MOV_MEMb_AL_8) = MOV<M8, R8>;

DEF_ISEL_Mn_Rn(MOV_MEMv_OrAX, MOV);

DEF_ISEL(MOV_GPR8_IMMb_D0_8) = MOV<R8W, I8>;

DEF_ISEL_Rn_In(MOV_GPRv_IMMv, MOV);
